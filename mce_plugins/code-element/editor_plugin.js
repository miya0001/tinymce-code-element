(function(){tinymce.create("tinymce.plugins.CodeElementPlugin",{init:function(a,b){a.addCommand("mceCodeElement",function(){a.execCommand("mceBeginUndoLevel");var d=a.dom.getParent(a.selection.getNode(),"CODE");if(d===null){if(a.selection.isCollapsed()){a.execCommand("mceInsertContent",false," <code>code</code> ")}else{var c=jQuery("<code />");c.html(a.selection.getContent());a.execCommand("mceReplaceContent",false,jQuery("<div />").append(c).html())}}else{a.execCommand("mceRemoveNode",false,d);a.nodeChanged()}a.execCommand("mceEndUndoLevel")});a.addButton("codeElement",{title:"Insert/edit code",cmd:"mceCodeElement",image:b+"/img/icon.png"});a.onNodeChange.add(function(d,c,e){c.setActive("codeElement",e.nodeName=="CODE")})},getInfo:function(){return{longname:"Code Element",author:"Takayuki Miyauchi",authorurl:"http://wpist.me/",infourl:"",version:"0.5"}}});tinymce.PluginManager.add("codeElement",tinymce.plugins.CodeElementPlugin)})();